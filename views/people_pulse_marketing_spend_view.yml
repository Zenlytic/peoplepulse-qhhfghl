version: 1
type: view
name: marketing_spend
model_name: peoplepulse_model
sql_table_name: DEMO.DEMO_PROD_PEOPLE_PULSE.PEOPLE_PULSE_MARKETING_SPEND
default_date: date
identifiers: []
fields:
  - name: engagement
    field_type: dimension
    type: number
    sql: ${TABLE}."ENGAGEMENT"

  - name: source
    field_type: dimension
    type: string
    sql: ${TABLE}."SOURCE"
    searchable: true

  - name: spend
    field_type: dimension
    type: number
    sql: ${TABLE}."SPEND"

  - name: channel
    field_type: dimension
    type: string
    sql: ${TABLE}."CHANNEL"
    searchable: true

  - name: reach
    field_type: dimension
    type: number
    sql: ${TABLE}."REACH"

  - name: conversion_rate
    field_type: dimension
    type: number
    sql: ${TABLE}."CONVERSION_RATE"
    hidden: true

  - name: campaign
    field_type: dimension
    type: string
    sql: ${TABLE}."CAMPAIGN"
    searchable: true

  - name: date
    field_type: dimension_group
    type: time
    datatype: timestamp
    timeframes:
      - raw
      - date
      - day_of_year
      - week
      - week_of_year
      - month
      - month_of_year
      - quarter
      - fiscal_month
      - fiscal_quarter
      - fiscal_quarter_of_year
      - fiscal_year
      - year
    sql: ${TABLE}."DATE"

  - name: number_of_campaigns_run
    field_type: measure
    type: count_distinct
    description: The total number of unique camaigns run.
    sql: ${campaign}

  - name: total_engagement
    field_type: measure
    type: sum
    description: The total sum of engagement across all marketing channels.
    sql: ${engagement}

  - name: total_spend
    field_type: measure
    type: sum
    description: The total sum of marketing spend.
    sql: ${spend}
    value_format_name: usd

  - name: total_reach
    field_type: measure
    type: sum
    description: The total sum of reach across all marketing channels.
    sql: ${reach}

  - name: spend_to_reach_ratio
    field_type: measure
    type: number
    description: >-
      The ratio of spend to reach, indicating how much is spent for each unit of
      reach.
    sql: NULLIF(${total_spend}, 0) / NULLIF(${total_reach}, 0)
