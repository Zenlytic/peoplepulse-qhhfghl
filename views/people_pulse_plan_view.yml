version: 1
type: view
name: people_pulse_plan
model_name: peoplepulse_model
sql_table_name: DEMO.DEMO_PROD_PEOPLE_PULSE.PEOPLE_PULSE_PLAN
default_date: date
identifiers:
- name: sales_rep_id
  type: foreign
  sql: ${sales_rep_id}
fields:
- name: sales_rep_id
  field_type: dimension
  type: number
  sql: ${TABLE}."SALES_REP_ID"

- name: daily_quota
  field_type: dimension
  type: number
  sql: ${TABLE}."DAILY_QUOTA"

- name: date
  field_type: dimension_group
  type: time
  datatype: timestamp
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - fiscal_month
  - fiscal_quarter
  - fiscal_quarter_of_year
  - fiscal_year
  - year
  sql: ${TABLE}."DATE"

- name: total_daily_quota
  field_type: measure
  type: sum
  description: The sum of daily quotas for all sales representatives.
  value_format_name: usd
  sql: ${daily_quota}

- name: quota_attainment
  field_type: measure
  type: number
  description: The total closed won in usd divided by the sum of daily quotas for
    all sales representatives.
  value_format_name: percent_1
  sql: ${sales_pipeline.closed_won_usd} / nullif(${total_daily_quota}, 0)
  is_merged_result: true
